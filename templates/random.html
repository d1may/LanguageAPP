{% extends "base.html" %}

{% block title %}Language · Random Word{% endblock %}

{% block extra_head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', path='/random.css') }}" data-theme-sheet="amber">
  <link rel="stylesheet" href="{{ url_for('static', path='/random.sapphire.css') }}" data-theme-sheet="sapphire" disabled>
{% endblock %}

{% block body_class %}random{% endblock %}

{% block header %}
  {% include "partials/header.html" %}
{% endblock %}

{% block content %}
<main class="random-shell">
  <section class="random-hero">
      <div>
        <p class="section-label">Daily discovery</p>
        <h2>Random Word Lab</h2>
        <p class="muted">Jump into a curated stream of English or German vocabulary and build context with one tap.</p>
        <p class="session-congrats" id="session-congrats" hidden></p>
      </div>
      <div class="hero-meta">
        <div class="meta-chip">
          <span class="meta-title">Current deck</span>
          <span id="word-lang" class="meta-value">English</span>
        </div>
        <div class="meta-chip" id="session-chip">
          <span class="meta-title">Session words</span>
          <span class="meta-value" id="session-words">0/10</span>
        </div>
      </div>
  </section>

  <section class="random-grid">
    <div class="word-panel">
      <header class="word-head">
        <div>
          <p class="section-label">Your word</p>
          <h3>Tap generate to refresh</h3>
        </div>
        <button id="btn-word" class="btn primary">Generate word</button>
      </header>

      <div class="word-display" id="word">Word</div>
      <div class="msg err" id="app-msg" hidden></div>

      <div class="word-actions">
        <button id="btn-trans" class="btn ghost">Translate</button>
        <button id="btn-add-deck" class="btn ghost" type="button">Add to deck</button>
      </div>

      <div id="translation-box" class="translation-box"></div>
    </div>

    <aside class="word-side">
      <div class="tip-card">
        <p class="section-label">Hints</p>
        <p class="tip-title">Rate each draw</p>
        <p class="muted">Mark how confident you feel. We’ll use it to prioritize future reviews.</p>
      </div>

      <div class="rating-panel">
        <p class="section-label">Difficulty</p>
        <div class="rating-btns">
          <button class="rate hard" data-rate="hard">Hard</button>
          <button class="rate ok" data-rate="ok">OK</button>
          <button class="rate easy" data-rate="easy">Easy</button>
        </div>
      </div>
    </aside>
  </section>

  <section class="word-library">
    <div class="library-head">
      <div>
        <p class="section-label">Library preview</p>
        <h3>Library snapshot</h3>
        <p class="muted">
          Single table view with quick sorting. We currently show the 10 latest words
          plus 10 words per rating bucket. Data comes directly from your deck.
        </p>
      </div>
      <div class="library-actions">
        <button type="button" id="btn-refresh-library" class="btn ghost">
          Refresh data
        </button>
        <button type="button" id="btn-save-library" class="btn library-save">
          Save data
        </button>
      </div>
    </div>

    <div class="library-controls">
      <p class="muted-small">Sort menu</p>
      <div class="library-menu" role="tablist">
        <button class="menu-btn active" data-library-filter="recent" role="tab">
          10 recent
        </button>
        <button class="menu-btn" data-library-filter="high" role="tab">
          10 confident
        </button>
        <button class="menu-btn" data-library-filter="medium" role="tab">
          10 medium
        </button>
        <button class="menu-btn" data-library-filter="low" role="tab">
          10 difficult
        </button>
      </div>
    </div>

    <div class="word-table-shell">
      <table class="word-table">
        <thead>
          <tr>
            <th>Word</th>
            <th>Definition</th>
            <th>Comment</th>
            <th>Rating</th>
          </tr>
        </thead>
        <tbody id="word-library-body">
          <tr>
            <td colspan="4" class="word-table-empty">Loading demo words…</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
</main>

<div class="deck-modal" id="random-add-modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="random-add-title">
  <div class="deck-modal-backdrop" data-modal-close></div>
  <div class="deck-modal-content">
    <header class="deck-modal-head">
      <div>
        <p class="panel-label">New card</p>
        <h3 id="random-add-title">Add word to deck</h3>
      </div>
      <button class="icon-btn small ghost" type="button" data-modal-close>Close</button>
    </header>
    <form class="deck-modal-form" id="random-add-form">
      <label class="deck-field">
        <span>Deck</span>
        <select name="deck_id" required data-random-deck-select>
          <option value="">Select a deck</option>
        </select>
      </label>
      <label class="deck-field">
        <span>Word</span>
        <input type="text" name="word" placeholder="e.g. Momentum" maxlength="50" required data-random-word-input>
      </label>
      <label class="deck-field">
        <span>Definition</span>
        <textarea name="definition" rows="3" placeholder="Short explanation" maxlength="255" required></textarea>
      </label>
      <label class="deck-field">
        <span>Example</span>
        <textarea name="example" rows="2" placeholder="Optional usage example" maxlength="255"></textarea>
      </label>
      <div class="deck-modal-actions">
        <button class="btn ghost" type="button" data-modal-close>Cancel</button>
        <button class="btn primary" type="submit">Save card</button>
      </div>
    </form>
    <p class="deck-modal-hint" data-random-add-hint>Pick a deck to store this word.</p>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script type="module" src="{{ url_for('static', path='/main-app.js') }}"></script>
{% endblock %}
